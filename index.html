<script>
    var rows = 4;
    var list_table = [
        { // [0] 第一列開始
            title: "網路新聞",
            items: [
                { div: "", title: "台視新聞", url: "https://www.youtube.com/watch?v=yk2CUjbyyQY" },
                { div: "", title: "華視新聞", url: "https://www.youtube.com/watch?v=WAGIkirjfCw" },
                { div: "", title: "民視新聞", url: "https://www.youtube.com/watch?v=XxJKnDLYZz4" },
                { div: "", title: "三立新聞", url: "https://www.youtube.com/watch?v=4ZVUmEUFwaY" },
                { div: "", title: "東森新聞", url: "https://www.youtube.com/c/newsebc/live" },
                { div: "", title: "HiChannel", url: "https://hichannel.hinet.net/radio/index.do" },
                { div: "", title: "", url: "" }
            ]
        },
        { // [1]
            title: "生活資訊",
            items: [
                { div: "", title: "2018記帳表", url: "https://docs.google.com/spreadsheets/d/1S9WFtPM4X1lem4F-yPlhTJP3uUVAatGek8XPOS2ZHHc" },
                { div: "", title: "油價", url: "https://gas.goodlife.tw" },
                { div: "", title: "即時天氣 - 新莊", url: "https://www.cwb.gov.tw/V7/observe/real/C0ACA.htm" },
                { div: "", title: "天氣預報", url: "https://www.cwb.gov.tw/V7/forecast/taiwan/Taipei_City.htm" },
                { div: "", title: "一週氣象", url: "https://www.cwb.gov.tw/V7/forecast/week/week.htm" },
                { div: "", title: "衛星雲圖", url: "https://www.cwb.gov.tw/V7/observe/satellite/Sat_EA.htm" },
                { div: "", title: "PM2.5", url: "https://taqm.epa.gov.tw/pm25" }
            ]
        },
        { // [2]
            title: "Google Service",
            items: [
                { div: "", title: "Gmail", url: "https://gmail.com" },
                { div: "", title: "行事曆", url: "https://www.google.com/calendar" },
                { div: "", title: "網路硬碟", url: "https://drive.google.com" },
                { div: "", title: "Keep", url: "https://keep.google.com" },
                { div: "", title: "Android Manager", url: "https://www.google.com/android/devicemanager" },
                { div: "", title: "Google Timeline", url: "https://www.google.com/maps/timeline" },
                { div: "", title: "", url: "" }
            ]
        },
        { // [3]
            title: "新聞資訊",
            items: [
                { div: "", title: "Google News", url: "https://news.google.com.tw" },
                { div: "", title: "Yahoo!奇摩新聞", url: "https://tw.news.yahoo.com" },
                { div: "", title: "UDN聯合新聞網", url: "https://udn.com" },
                { div: "", title: "給台灣人的國際新聞", url: "https://www.newsfortw.com" },
                { div: "", title: "", url: "" },
                { div: "", title: "", url: "" },
                { div: "", title: "", url: "" }
            ]
        },
        { // [4] 第二列開始
            title: "交通資訊",
            items: [
                { div: "", title: "台鐵時刻表", url: "http://twtraffic.tra.gov.tw/twrail" },
                { div: "", title: "高鐵時刻表", url: "https://www.thsrc.com.tw/index.html" },
                { div: "", title: "台鐵訂票系統", url: "http://railway.hinet.net" },
                { div: "", title: "高鐵訂票系統", url: "https://irs.thsrc.com.tw/IMINT/?locale=tw" },
                { div: "", title: "大台北公車", url: "https://ebus.gov.taipei/Query/BusDynamicMainList" },
                { div: "", title: "", url: "" },
                { div: "", title: "", url: "" }
            ]
        },
        { // [5]
            title: "股市資訊",
            items: [
                { div: "", title: "國際重要指數", url: "https://histock.tw/index" },
                { div: "", title: "Yahoo 大盤線圖", url: "https://tw.stock.yahoo.com/t/idx.php" },
                { div: "", title: "HiStock 大盤指標", url: "https://histock.tw/stock/tchart.aspx?no=0000&m=b" },
                { div: "", title: "HiStock 大盤籌碼", url: "https://histock.tw/stock/three.aspx" },
                { div: "", title: "Yahoo 道瓊", url: "https://finance.yahoo.com/quote/%5EDJI/news?p=%5EDJI" },
                { div: "", title: "Investing 期貨", url: "https://www.investing.com/indices/indices-futures" },
                { div: "", title: "股票筆記", url: "https://docs.google.com/document/d/1iA1Rque7zVkWTskYecCK-_WAkzZuoJdX5RUy-yVfYxs/edit#" }
            ]
        },
        { // [6]
            title: "股市資訊",
            items: [
                { div: "", title: "上市日報表", url: "http://bsr.twse.com.tw/bshtm" },
                { div: "", title: "上櫃日報表", url: "http://www.gretai.org.tw/ch/stock/aftertrading/broker_trading/brokerBS.php" },
                { div: "", title: "三大法人-期貨", url: "http://www.taifex.com.tw/cht/3/futContractsDateExcel" },
                { div: "", title: "三大法人-選擇權", url: "http://www.taifex.com.tw/cht/3/optContractsDateExcel" },
                { div: "", title: "三大法人-現貨", url: "http://www.twse.com.tw/zh/page/trading/fund/BFI82U.html" },
                { div: "", title: "八大行庫", url: "http://www.capitalfutures.com.tw/Research/SectionJ/default_page.aspx?type=14" },
                { div: "", title: "", url: "" }
            ]
        },
        { // [7]
            title: "股市資訊",
            items: [
                { div: "", title: "NVESTO", url: "https://www.nvesto.com" },
                { div: "", title: "安納金", url: "https://moneynmall.moneybar.com.tw/expertsDetail.php?expert_id=14" },
                { div: "", title: "飯大叔", url: "https://www.facebook.com/naribuchi.natsu" },
                { div: "", title: "交易者的E甸園", url: "http://ebigmoney.pixnet.net/blog" },
                { div: "", title: "", url: "" },
                { div: "", title: "IFRS 財務報表", url: "http://mops.twse.com.tw/server-java/t164sb01" },
                { div: "", title: "產業價值鏈資訊平台", url: "https://ic.tpex.org.tw" }
            ]
        },
        { // [8] 第三列開始
            title: "購物 & 網路書店",
            items: [
                { div: "", title: "Yahoo!購物中心", url: "https://buy.yahoo.com.tw" },
                { div: "", title: "PCHome線上購物", url: "https://shopping.pchome.com.tw" },
                { div: "", title: "MOMO購物", url: "https://www.momoshop.com.tw" },
                { div: "", title: "蝦皮購物", url: "https://shopee.tw" },
                { div: "", title: "露天拍賣", url: "https://www.ruten.com.tw" },
                { div: "", title: "天瓏書局", url: "https://www.tenlong.com.tw" },
                { div: "", title: "Findbook", url: "https://findbook.tw" }

            ]
        },
        { // [9]
            title: "其他",
            items: [
                { div: "", title: "HackMD筆記", url: "https://hackmd.io/s/SJUOsEo8g" },
                { div: "", title: "待整理筆記", url: "https://docs.google.com/document/d/1Tr7J08iTbq3phaPw-WGerdIi03ZJs596sR5v6txnIgk/edit#heading=h.53fv9h71ggc4" },
                { div: "", title: "Trello - ToDo", url: "https://trello.com/b/8Y9Z4fzu/todo" },
                { div: "", title: "My Urls", url: "https://hackmd.io/s/B19p-moUg" },
                { div: "", title: "Jserv - C語言", url: "https://hackmd.io/s/HJpiYaZfl" },
                { div: "", title: "羅習五-2018 OS", url: "https://www.dropbox.com/sh/4q6d2roxc8x650b/AADqV9NVVqHr5R9CIPwqYR8Ia?dl=0" },
                { div: "", title: "Modify This Page", url: "https://github.com/zzzaaa12/zzzaaa12.github.io/blob/master/index.html" }
            ]
        },
        { // [10]
            title: "虛擬貨幣",
            items: [
                { div: "", title: "CoinMarketCap", url: "" },
                { div: "", title: "動區 BlockTempo", url: "" },
                { div: "", title: "MAX交易所", url: "" },
                { div: "usd", title: "USD: 00.00 NTD", url: "" },
                { div: "btc", title: "BTC: 000 (+0%)", url: "" },
                { div: "eth", title: "ETH: 000 (+0%)", url: "" },
                { div: "iota", title: "MIOTA: 0.00 (+0%)", url: "" }
            ]
        },
        { // [11]
            title: "即時資訊",
            items: [
                { div: "", title: "溫溼度", url: "https://thingspeak.com/channels/72313" },
                { div: "", title: "全部圖表", url: "http://zzzaaa12.github.com/sensor2.html" },
                { div: "living_room", title: "客廳：00°C, 00%", url: "" },
                { div: "room1", title: "主臥：00°C, 00%", url: "" },
                { div: "room2", title: "客房：00°C, 00%", url: "" },
                { div: "room3", title: "書房：00°C, 00%", url: "" },
                { div: "pm25", title: "PM 2.5：16 ug/m3", url: "" }
            ]
        }
    ];
</script>

<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>zzzaaa12's index</title>
    <style type="text/css">
        body {
            font-size: 9pt;
            background-color: #000000;
        }

        table {
            border-collapse: collapse;
            border-color: #707070;
        }

        td {
            empty-cells: show;
            color: #FFFF00;
            text-align: center;
            border-color: #707070;
        }

        td.title {
            font-weight: bolder;
            color: #000000;
            background-color: #FF9933;
        }

        a {
            color: #FFFF00;
        }

        a {
            text-decoration: none
        }

        a:hover {
            color: #707070;
        }

        div {
            color: #80FF00;
        }
    </style>
    <style type="text/css"></style>
</head>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ="
    crossorigin="anonymous"></script>

<body>
    <script>
        var item_title = "";
        var item_url = "";
        var i, j;
        document.write("<table border=\"0\" width=\"100%\" height=\"100%\" align=\"center\" valign=\"center\"><tbody><tr><td>");
        document.write("<table border=\"0\" width=\"75%\" height=\"80%\" align=\"center\"><tbody>");
        document.write("<tr valign=\"top\">");
        for (i = 0; i < list_table.length; i++) {
            document.write("<td>");
            document.write("<table border=\"1\" width=\"160\" align=\"center\"><tbody>");
            document.write("<tr><td class=\"title\">" + list_table[i].title + "</td></tr>");

            for (j = 0; j < 7; j++) {
                item_title = list_table[i].items[j].title;
                item_url = list_table[i].items[j].url;
                item_div = list_table[i].items[j].div;
                if (item_title == "")
                    item_title = "　";

                document.write("<tr><td><div class=\"" + item_div + "\"><a href=\"" + item_url + "\">" + item_title + "</a></div></td></tr>");
            }

            document.write("</tbody></table>");
            document.write("</td>");

            if (i % rows == rows-1) {
                document.write("</tr>");
                document.write("<tr valign=\"top\">");
            }
        }
        document.write("</tr>");
        document.write("</tbody></table>");
        document.write("</td></tr></tbody></table>");
    </script>


</body>

</html>
<script>
    var max = 20;
    var living_room_t = 0, living_room_h = 0;
    var room1_t = 0, room1_h = 0;
    var room2_t = 0, room2_h = 0;
    var room3_t = 0, room3_h = 0;
    var pm25 = 0
    var plant_level = -1, plant_water_times = -1;

    /* DHT22 Sensor */
    $.getJSON("https://api.thingspeak.com/channels/72313/feeds.json?results=" + String(max),
        function (data) {
            $.each(data, function (key, val) {
                if (key == "feeds") {
                    for (var i = 0; i < max; i++) {
                        if (val[i].field1 && val[i].field2) {
                            living_room_t = val[i].field1;
                            living_room_h = val[i].field2;
                        } else if (val[i].field3 && val[i].field4) {
                            room1_t = parseInt(val[i].field3);
                            room1_h = parseInt(val[i].field4);
                        } else if (val[i].field5 && val[i].field6) {
                            room2_t = parseInt(val[i].field5);
                            room2_h = parseInt(val[i].field6);
                        } else if (val[i].field7 && val[i].field8) {
                            room3_t = parseInt(val[i].field7);
                            room3_h = parseInt(val[i].field8);
                        }
                    }

                    if (living_room_h >= 80)
                        $("div.living_room").css("color", "red");
                    else if (living_room_h >= 70)
                        $("div.living_room").css("color", "orange");

                    if (room1_h >= 80)
                        $("div.room1").css("color", "red");
                    else if (room1_h >= 70)
                        $("div.room1").css("color", "orange");

                    if (room2_h >= 80)
                        $("div.room2").css("color", "red");
                    else if (room2_h >= 70)
                        $("div.room2").css("color", "orange");

                    if (room3_h >= 80)
                        $("div.room3").css("color", "red");
                    else if (room3_h >= 70)
                        $("div.room3").css("color", "orange");

                    $("div.living_room").html("客廳：" + living_room_t + "°C, " + living_room_h + "%");
                    $("div.room1").html("主臥：" + room1_t + "°C, " + room1_h + "%");
                    $("div.room2").html("客房：" + room2_t + "°C, " + room2_h + "%");
                    $("div.room3").html("書房：" + room3_t + "°C, " + room3_h + "%");
                }
            });
        });

    /* Air Sensor */
    $.getJSON("https://api.thingspeak.com/channels/72839/feeds.json?results=" + String(max),
        function (data) {
            $.each(data, function (key, val) {
                if (key == "feeds") {
                    for (var i = 0; i < max; i++) {
                        if (val[i].field2)
                            pm25 = parseInt(val[i].field2);
                    }

                    if (pm25 >= 40)
                        $("div.pm25").css("color", "red");
                    else if (pm25 >= 20)
                        $("div.pm25").css("color", "orange");

                    $("div.pm25").html("PM 2.5：" + pm25 + " ug/m3");
                }
            });
        });

    /* Cryptocurrency */
    $.getJSON("https://api.coinmarketcap.com/v2/ticker/?convert=TWD&limit=20",
        function (data) {
            for (var key in data.data) {
                var coin = data.data[key];
                var percentage = coin.quotes.USD.percent_change_24h;
                var price = parseFloat(coin.quotes.USD.price);
                var div = '';
                var sign = '';
                var color = "red";

                if (coin.name == "Bitcoin") {
                    div = "div.btc";
                    $('div.usd').html("USD: " + String((parseFloat(coin.quotes.TWD.price) / parseFloat(coin.quotes.USD.price)).toFixed(2)) + " NTD");
                } else if (coin.name == "Ethereum") {
                    div = "div.eth";
                } else if (coin.name == "IOTA") {
                    div = "div.iota";
                } else {
                    continue;
                }

                if (percentage > 0) {
                    sign = '+';
                    color = "#80FF00";
                }

                if (parseInt(price) == 0)
                    price = price.toFixed(2);
                else
                    price = parseInt(price);

                $(div).css("color", color);
                $(div).html(coin.symbol + ": " + String(price) + " (" + sign + parseInt(percentage) + "%)");
            }
        });

    /* Auto Reload */
    setTimeout(function () { window.location = window.location; }, 300000);
</script>
